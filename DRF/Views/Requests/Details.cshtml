@model DRF.ViewModels.RequestDetailViewModel

@{
    ViewData["Title"] = "Request Details";
}
<link href="~/css/requestdetailsstyles.css" rel="stylesheet" />
<div class="container mt-4">

    <!-- Bootstrap Tabs -->
    <ul class="nav nav-tabs" id="requestDetailsTabs" role="tablist">
        <li class="nav-item" role="presentation">
            <button class="nav-link active" id="overview-tab" data-bs-toggle="tab" data-bs-target="#overview" type="button" role="tab" aria-controls="overview" aria-selected="true">Overview</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="project-tab" data-bs-toggle="tab" data-bs-target="#project" type="button" role="tab" aria-controls="project" aria-selected="false">Project Details</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="criteria-tab" data-bs-toggle="tab" data-bs-target="#criteria" type="button" role="tab" aria-controls="criteria" aria-selected="false">Criteria</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link" id="meta-tab" data-bs-toggle="tab" data-bs-target="#meta" type="button" role="tab" aria-controls="meta" aria-selected="false">Metadata</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link tab-blue" id="timeline-tab" data-bs-toggle="tab" data-bs-target="#timeline" type="button" role="tab" aria-controls="timeline" aria-selected="false">Timeline</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link tab-blue" id="comments-tab" data-bs-toggle="tab" data-bs-target="#comments" type="button" role="tab" aria-controls="comments" aria-selected="false">Comments</button>
        </li>
        <li class="nav-item" role="presentation">
            <button class="nav-link tab-yellow" id="data-tab" data-bs-toggle="tab" data-bs-target="#data-upload" type="button" role="tab" aria-controls="data-upload" aria-selected="false">Data</button>
        </li>
    </ul>

    <div class="tab-content" id="requestDetailsTabsContent">
        <!-- Overview Tab -->
        <div class="tab-pane fade show active" id="overview" role="tabpanel" aria-labelledby="overview-tab">
            <div class="p-3">
                <p><strong>Request ID:</strong> @Model.Id</p>
                <p><strong>Third Party Organization:</strong> @Model.ThirdPartyOrganization</p>
                <p><strong>Program Title:</strong> @Model.ProgramTitle</p>
                <p><strong>Brief on Program:</strong> @Model.BriefOnProgram</p>
                <p><strong>Total Target:</strong> @Model.TotalTarget</p>
                <p><strong>Target Request:</strong> @Model.TargetRequest</p>
            </div>
        </div>

        <!-- Project Details Tab -->
        <div class="tab-pane fade" id="project" role="tabpanel" aria-labelledby="project-tab">
            <div class="p-3">
                <p><strong>Project Start Date:</strong> @Model.ProjectStartDate?.ToString("yyyy-MM-dd")</p>
                <p><strong>Project End Date:</strong> @Model.ProjectEndDate?.ToString("yyyy-MM-dd")</p>
                <p><strong>Referral Delivery Deadline:</strong> @Model.ReferralDeliveryDL?.ToString("yyyy-MM-dd")</p>
                <p><strong>Referral Total:</strong> @Model.ReferralTotal</p>
                <p><strong>Counterpart:</strong> @Model.CounterPart</p>
                <p><strong>Contact Person:</strong> @Model.ContactPerson</p>
            </div>
        </div>

        <!-- Criteria Tab -->
        <div class="tab-pane fade" id="criteria" role="tabpanel" aria-labelledby="criteria-tab">
            <div class="p-3">
                <p>@Model.Criteria</p>
            </div>
        </div>

        <!-- Metadata Tab -->
        <div class="tab-pane fade" id="meta" role="tabpanel" aria-labelledby="meta-tab">
            <div class="p-3">
                <p><strong>Current Status:</strong> @Model.CurrentStatus</p>
                <p><strong>Data File URL:</strong> <a href="@Model.DataFileUrl" target="_blank">@Model.DataFileUrl</a></p>
                <p><strong>Created By:</strong> @Model.CreatedBy</p>
                <p><strong>Created At:</strong> @Model.CreatedAt.ToString("yyyy-MM-dd")</p>
                <p><strong>Hired Self-Employed:</strong> @(Model.HiredSelfEmployed == 1 ? "Yes" : "No")</p>
            </div>
        </div>

        <!-- Timeline Tab -->
        <div class="tab-pane fade" id="timeline" role="tabpanel" aria-labelledby="timeline-tab">
            <div class="p-3">
                <div id="timeline"></div>
            </div>
        </div>

        <!-- Data Tab -->
        <div class="tab-pane fade" id="data-upload" role="tabpanel" aria-labelledby="data-tab">
            <div class="p-3">
                <h5>Upload Data File</h5>
                <form id="dataUploadForm" enctype="multipart/form-data">
                    <div class="mb-3">
                        <label for="dataFile" class="form-label">Select a file to upload:</label>
                        <input class="form-control" type="file" id="dataFile" name="dataFile" required>
                    </div>
                    <button type="submit" class="btn btn-primary">Upload</button>
                </form>
                <div id="uploadResult" class="mt-3"></div>
            </div>
        </div>

    </div>
</div>

<script src="~/js/requestupdates.js"></script>
<script>
    // Bootstrap
    var tabEl = document.querySelectorAll('button[data-bs-toggle="tab"]');
    tabEl.forEach(function (tab) {
        tab.addEventListener('shown.bs.tab', function (event) {
            event.target
            event.relatedTarget
        })
    });

    // Call the function from RequestUpdates.js
    // initializeKendoTimeline(@Model.Id);
</script>